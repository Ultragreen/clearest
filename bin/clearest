#!/usr/bin/env ruby
require 'clearest'
require 'thor'

module CleaRESTCLI
  class Application < Thor
    desc "new <name> <dsn>", "Adds a new CleaREST application"
    def new(name,dsn)
      Clearest::ApplicationBuilder::new :project_name => name, :target_path => '.', :dsn => dsn
    end

    desc "show", "Display information on the current application"
    def rename
    end
  end


  class Services < Thor
    desc "add <table> <dsn>", "Adds the new service named <table>  on the <dsn> to the current application"
    def add(table,dsn)
#      Clearest::ApplicationValidator::check :path => '.'
      Clearest::ServiceBuilder::new :table_name => table, :dsn => dsn, :project_name => 'testing', :target_path => '/tmp'
    end
    desc "remove <name>", "remove service <name> of the current application"
    def remove(name)

    end

  end

  class CleaREST < Thor
    desc "application SUBCOMMAND ...ARGS", "manage CleaREST application"
    subcommand "application", Application
    desc "services SUBCOMMAND ...ARGS", "manage services in application"
    subcommand "services", Services
  end
end

CleaRESTCLI::CleaREST.start(ARGV)


